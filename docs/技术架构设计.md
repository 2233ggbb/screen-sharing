# å¤šäººå±å¹•å…±äº«ç³»ç»Ÿ - æŠ€æœ¯æ¶æ„è®¾è®¡æ–‡æ¡£

## æ–‡æ¡£ä¿¡æ¯

| é¡¹ç›®åç§° | å¤šäººå±å¹•å…±äº«ç³»ç»Ÿ |
|---------|-----------------|
| æ–‡æ¡£ç‰ˆæœ¬ | v1.0 |
| åˆ›å»ºæ—¥æœŸ | 2026-01-04 |
| æ–‡æ¡£ç±»å‹ | æŠ€æœ¯æ¶æ„è®¾è®¡ |

---

## 1. æŠ€æœ¯æ¶æ„æ¦‚è§ˆ

### 1.1 æ•´ä½“æ¶æ„

æœ¬ç³»ç»Ÿé‡‡ç”¨ **å®¢æˆ·ç«¯-æœåŠ¡ç«¯ï¼ˆC/Sï¼‰æ¶æ„**ï¼Œç»“åˆ **WebRTC P2P** å’Œ **ä¿¡ä»¤æœåŠ¡å™¨** å®ç°å®æ—¶å±å¹•å…±äº«ã€‚æ”¯æŒ **æ¡Œé¢ç«¯ (Electron)** å’Œ **ç§»åŠ¨ç«¯ (React Native)** äº’é€šã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•´ä½“æ¶æ„å›¾                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  æ¡Œé¢å®¢æˆ·ç«¯   â”‚                           â”‚  ç§»åŠ¨å®¢æˆ·ç«¯   â”‚
  â”‚  (Electron)  â”‚                           â”‚(React Native)â”‚
  â”‚              â”‚                           â”‚              â”‚
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                           â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚ â”‚ å±å¹•æ•è·  â”‚ â”‚                           â”‚ â”‚ å±å¹•æ•è·  â”‚ â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                           â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                           â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚ â”‚  WebRTC  â”‚ â”‚                           â”‚ â”‚  WebRTC  â”‚ â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                           â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                         â”‚
          â”‚  åª’ä½“æµ (P2P)                           â”‚
          â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚
          â”‚                                         â”‚
          â”‚ ä¿¡ä»¤ (WSS)            ä¿¡ä»¤ (WSS)        â”‚
          â”‚                                         â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚              â”‚
                     â–¼              â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚      ä¿¡ä»¤æœåŠ¡å™¨ (Node.js)       â”‚
          â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
          â”‚    â”‚  Socket.io Server   â”‚     â”‚
          â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
          â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
          â”‚    â”‚   æˆ¿é—´ç®¡ç†æœåŠ¡       â”‚     â”‚
          â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
          â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
          â”‚    â”‚   ç”¨æˆ·ç®¡ç†æœåŠ¡       â”‚     â”‚
          â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ¶æ„ç‰¹ç‚¹

- **æ··åˆæ¶æ„**: ä¿¡ä»¤é€šè¿‡æœåŠ¡å™¨ä¸­è½¬ï¼Œåª’ä½“æµé‡‡ç”¨P2Pç›´è¿
- **å»ä¸­å¿ƒåŒ–åª’ä½“**: åª’ä½“æµä¸ç»è¿‡æœåŠ¡å™¨ï¼Œé™ä½æœåŠ¡å™¨å‹åŠ›
- **å…¨åŒå·¥é€šä¿¡**: ä½¿ç”¨WebSocketå®ç°å®æ—¶åŒå‘é€šä¿¡
- **å…¨å¹³å°æ”¯æŒ**: è¦†ç›– Windows/macOS/Linux åŠ Android å¹³å°

---

## 2. æŠ€æœ¯æ ˆé€‰å‹

### 2.1 æ¡Œé¢å®¢æˆ·ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰å‹ç†ç”± |
|------|------|------|---------|
| **Electron** | 28+ | æ¡Œé¢åº”ç”¨æ¡†æ¶ | è·¨å¹³å°ã€æˆç†Ÿç¨³å®šã€æ”¯æŒåŸç”ŸAPI |
| **React** | 18+ | UIæ¡†æ¶ | ç»„ä»¶åŒ–ã€ç”Ÿæ€ä¸°å¯Œã€å¼€å‘æ•ˆç‡é«˜ |
| **TypeScript** | 5+ | ç¼–ç¨‹è¯­è¨€ | ç±»å‹å®‰å…¨ã€æå‡ä»£ç è´¨é‡ |
| **Vite** | 5+ | æ„å»ºå·¥å…· | å¿«é€Ÿæ„å»ºã€HMRä½“éªŒå¥½ |
| **WebRTC** | åŸç”ŸAPI | éŸ³è§†é¢‘ä¼ è¾“ | æ ‡å‡†åè®®ã€æµè§ˆå™¨åŸç”Ÿæ”¯æŒ |
| **Socket.io Client** | 4+ | WebSocketå®¢æˆ·ç«¯ | è‡ªåŠ¨é‡è¿ã€å…¼å®¹æ€§å¥½ |
| **Zustand** | 4+ | çŠ¶æ€ç®¡ç† | è½»é‡çº§ã€ç®€å•æ˜“ç”¨ |
| **Ant Design** | 5+ | UIç»„ä»¶åº“ | ç»„ä»¶ä¸°å¯Œã€ä¼ä¸šçº§ã€æ”¯æŒLesså®šåˆ¶ |
| **Less** | 4+ | CSSé¢„å¤„ç†å™¨ | å˜é‡ã€åµŒå¥—ã€æ··å…¥åŠŸèƒ½ |
| **CSS Modules** | - | CSSæ¨¡å—åŒ– | æ ·å¼éš”ç¦»ã€é¿å…å†²çª |

### 2.1.1 ä»£ç è´¨é‡å·¥å…·

| å·¥å…· | ç‰ˆæœ¬ | ç”¨é€” | é…ç½® |
|------|------|------|------|
| **ESLint** | 8+ | ä»£ç æ£€æŸ¥ | Airbnbè§„èŒƒ + TypeScript |
| **Prettier** | 3+ | ä»£ç æ ¼å¼åŒ– | ç»Ÿä¸€ä»£ç é£æ ¼ |
| **Stylelint** | 15+ | æ ·å¼æ£€æŸ¥ | Less/CSSè§„èŒƒæ£€æŸ¥ |
| **lint-staged** | 15+ | Gitæäº¤æ£€æŸ¥ | æäº¤å‰è‡ªåŠ¨æ£€æŸ¥ |
| **Husky** | 8+ | Gité’©å­ | è‡ªåŠ¨åŒ–æäº¤æµç¨‹ |

### 2.1.2 æµ‹è¯•å·¥å…·

| å·¥å…· | ç‰ˆæœ¬ | ç”¨é€” | è¯´æ˜ |
|------|------|------|------|
| **Jest** | 29+ | å•å…ƒæµ‹è¯•æ¡†æ¶ | å¿«é€Ÿã€å®Œæ•´çš„æµ‹è¯•æ–¹æ¡ˆ |
| **@testing-library/react** | 14+ | Reactç»„ä»¶æµ‹è¯• | ä»¥ç”¨æˆ·è§’åº¦æµ‹è¯•ç»„ä»¶ |
| **@testing-library/jest-dom** | 6+ | DOMæ–­è¨€ | æ‰©å±•Jestçš„DOMåŒ¹é…å™¨ |
| **Playwright** | 1.40+ | E2Eæµ‹è¯• | è·¨æµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯• |
| **@types/jest** | 29+ | Jestç±»å‹å®šä¹‰ | TypeScriptæ”¯æŒ |

### 2.2 ç§»åŠ¨å®¢æˆ·ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰å‹ç†ç”± |
|------|------|------|---------|
| **React Native** | 0.76+ | ç§»åŠ¨åº”ç”¨æ¡†æ¶ | è·¨å¹³å°ã€æ€§èƒ½ä¼˜ç§€ã€å¤ç”¨ React çŸ¥è¯† |
| **TypeScript** | 5+ | ç¼–ç¨‹è¯­è¨€ | ç±»å‹å®‰å…¨ã€æå‡ä»£ç è´¨é‡ |
| **React Native Paper** | 5+ | UI ç»„ä»¶åº“ | éµå¾ª Material Design è§„èŒƒ |
| **react-native-webrtc** | 124+ | WebRTC å®ç° | æä¾›åŸç”Ÿ WebRTC èƒ½åŠ› |
| **Socket.io Client** | 4+ | WebSocketå®¢æˆ·ç«¯ | ä¸æœåŠ¡ç«¯é€šä¿¡ |
| **Zustand** | 5+ | çŠ¶æ€ç®¡ç† | è½»é‡çº§çŠ¶æ€ç®¡ç† |
| **React Navigation** | 7+ | è·¯ç”±å¯¼èˆª | åŸç”Ÿä½“éªŒçš„å¯¼èˆªåº“ |

### 2.3 æœåŠ¡ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰å‹ç†ç”± |
|------|------|------|---------|
| **Node.js** | 20+ | è¿è¡Œæ—¶ | é«˜å¹¶å‘ã€å¼‚æ­¥IOã€ç”Ÿæ€ä¸°å¯Œ |
| **Express** | 4+ | Webæ¡†æ¶ | ç®€å•ã€çµæ´»ã€ä¸­é—´ä»¶ä¸°å¯Œ |
| **Socket.io** | 4+ | WebSocketæœåŠ¡ç«¯ | å®æ—¶é€šä¿¡ã€è‡ªåŠ¨é™çº§ |
| **TypeScript** | 5+ | ç¼–ç¨‹è¯­è¨€ | ç±»å‹å®‰å…¨ã€ä¸å®¢æˆ·ç«¯å…±äº«ç±»å‹ |
| **Winston** | 3+ | æ—¥å¿—åº“ | åŠŸèƒ½å¼ºå¤§ã€æ”¯æŒå¤šç§è¾“å‡º |

### 2.3.1 ä»£ç è´¨é‡å·¥å…·

| å·¥å…· | ç‰ˆæœ¬ | ç”¨é€” | é…ç½® |
|------|------|------|------|
| **ESLint** | 8+ | ä»£ç æ£€æŸ¥ | Node.js + TypeScriptè§„èŒƒ |
| **Prettier** | 3+ | ä»£ç æ ¼å¼åŒ– | ç»Ÿä¸€ä»£ç é£æ ¼ |
| **lint-staged** | 15+ | Gitæäº¤æ£€æŸ¥ | æäº¤å‰è‡ªåŠ¨æ£€æŸ¥ |
| **Husky** | 8+ | Gité’©å­ | è‡ªåŠ¨åŒ–æäº¤æµç¨‹ |

### 2.3.2 æµ‹è¯•å·¥å…·

| å·¥å…· | ç‰ˆæœ¬ | ç”¨é€” | è¯´æ˜ |
|------|------|------|------|
| **Jest** | 29+ | å•å…ƒæµ‹è¯•æ¡†æ¶ | æœåŠ¡ç«¯å•å…ƒæµ‹è¯• |
| **Supertest** | 6+ | HTTPæµ‹è¯• | æµ‹è¯•Expressæ¥å£ |
| **Socket.io Client** | 4+ | Socketæµ‹è¯• | æµ‹è¯•WebSocketè¿æ¥ |
| **@types/jest** | 29+ | Jestç±»å‹å®šä¹‰ | TypeScriptæ”¯æŒ |

### 2.4 å¯é€‰æœåŠ¡

| æœåŠ¡ | ç”¨é€” | æ¨èæ–¹æ¡ˆ | è¯´æ˜ |
|------|------|---------|------|
| **STUNæœåŠ¡å™¨** | NATç©¿é€ | Googleå…¬å…±STUNæˆ–è‡ªå»º | ç”¨äºè·å–å…¬ç½‘åœ°å€ |
| **TURNæœåŠ¡å™¨** | åª’ä½“ä¸­ç»§ | ç”¨æˆ·è‡ªå»º (Coturn) | æœ¬é¡¹ç›®ä¸æä¾›ï¼Œéœ€è‡ªè¡Œéƒ¨ç½² |
| **ç›‘æ§æœåŠ¡** | ç³»ç»Ÿç›‘æ§ | Prometheus + Grafana | å¯é€‰ |

**æ³¨æ„**ï¼šæœ¬é¡¹ç›®ä»…æ”¯æŒ P2P ç›´è¿ï¼Œä¸æä¾› TURN ä¸­ç»§æœåŠ¡å™¨ã€‚å¦‚éœ€åœ¨å¤æ‚ NAT ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œè¯·è‡ªè¡Œéƒ¨ç½² TURN æœåŠ¡å™¨ã€‚

---

## 3. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 3.1 æ¡Œé¢å®¢æˆ·ç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Electron ä¸»è¿›ç¨‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ çª—å£ç®¡ç†      â”‚  â”‚ IPCé€šä¿¡       â”‚  â”‚ ç³»ç»Ÿé›†æˆ      â”‚     â”‚
â”‚  â”‚ - åˆ›å»ºçª—å£    â”‚  â”‚ - å±å¹•æ•è·    â”‚  â”‚ - æ‰˜ç›˜å›¾æ ‡    â”‚     â”‚
â”‚  â”‚ - çª—å£æ§åˆ¶    â”‚  â”‚ - åº”ç”¨æ§åˆ¶    â”‚  â”‚ - ç³»ç»Ÿé€šçŸ¥    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ IPC Bridge
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Electron æ¸²æŸ“è¿›ç¨‹                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    UI Layer (React)                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚é¦–é¡µç»„ä»¶  â”‚ â”‚æˆ¿é—´ç»„ä»¶  â”‚ â”‚è®¾ç½®ç»„ä»¶  â”‚ â”‚å…±äº«ç»„ä»¶  â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              State Management (Zustand)             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚æˆ¿é—´çŠ¶æ€   â”‚ â”‚ç”¨æˆ·çŠ¶æ€   â”‚ â”‚æµçŠ¶æ€     â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Service Layer                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚  WebRTCæœåŠ¡     â”‚ â”‚  SocketæœåŠ¡     â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - PeerConnectionâ”‚ â”‚ - äº‹ä»¶ç›‘å¬      â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - æµç®¡ç†        â”‚ â”‚ - æ¶ˆæ¯å‘é€      â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - ä¿¡ä»¤å¤„ç†      â”‚ â”‚ - æˆ¿é—´ç®¡ç†      â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚  â”‚  å±å¹•æ•è·æœåŠ¡    â”‚                                  â”‚   â”‚
â”‚  â”‚  â”‚ - æºåˆ—è¡¨è·å–     â”‚                                  â”‚   â”‚
â”‚  â”‚  â”‚ - æµåˆ›å»º        â”‚                                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.1.1 ä¸»è¿›ç¨‹èŒè´£

- **çª—å£ç”Ÿå‘½å‘¨æœŸç®¡ç†**: åˆ›å»ºã€æ˜¾ç¤ºã€éšè—ã€å…³é—­çª—å£
- **ç³»ç»ŸAPIè°ƒç”¨**: è®¿é—®ç³»ç»Ÿçº§åŠŸèƒ½ï¼ˆå±å¹•æ•è·ã€é€šçŸ¥ç­‰ï¼‰
- **IPCé€šä¿¡æ¡¥æ¥**: ä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹çš„æ¶ˆæ¯ä¼ é€’
- **åº”ç”¨ç”Ÿå‘½å‘¨æœŸ**: å¤„ç†åº”ç”¨å¯åŠ¨ã€é€€å‡ºã€æ›´æ–°ç­‰

#### 3.1.2 æ¸²æŸ“è¿›ç¨‹èŒè´£

- **UIæ¸²æŸ“**: ä½¿ç”¨Reactæ¸²æŸ“ç”¨æˆ·ç•Œé¢
- **çŠ¶æ€ç®¡ç†**: ç®¡ç†åº”ç”¨å…¨å±€çŠ¶æ€
- **ä¸šåŠ¡é€»è¾‘**: WebRTCè¿æ¥ã€Socketé€šä¿¡ã€å±å¹•å…±äº«ç­‰
- **ç”¨æˆ·äº¤äº’**: å¤„ç†ç”¨æˆ·æ“ä½œå’Œäº‹ä»¶

#### 3.1.3 é¢„åŠ è½½è„šæœ¬èŒè´£

- **APIæš´éœ²**: å®‰å…¨åœ°æš´éœ²ä¸»è¿›ç¨‹åŠŸèƒ½åˆ°æ¸²æŸ“è¿›ç¨‹
- **ä¸Šä¸‹æ–‡éš”ç¦»**: ç¡®ä¿æ¸²æŸ“è¿›ç¨‹æ— æ³•ç›´æ¥è®¿é—®Node.js API
- **å®‰å…¨æ¡¥æ¥**: éªŒè¯å’Œè¿‡æ»¤IPCæ¶ˆæ¯

### 3.2 ç§»åŠ¨å®¢æˆ·ç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   React Native Application                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    UI Layer                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚Home     â”‚ â”‚Room     â”‚ â”‚VideoGridâ”‚ â”‚Settings â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              State Management (Zustand)             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚  â”‚useRoom   â”‚ â”‚useUser   â”‚ â”‚useStream â”‚             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Service Layer                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚  WebRTCService â”‚ â”‚  SocketService â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚         ScreenCaptureService      â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Native Modules                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚ MediaProjectionâ”‚ â”‚ ForegroundSvc  â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.1 æ ¸å¿ƒæ¨¡å—èŒè´£
- **SocketService**: å°è£… Socket.io è¿æ¥å’Œäº‹ä»¶å¤„ç†
- **WebRTCService**: ç®¡ç† P2P è¿æ¥å’Œåª’ä½“æµ
- **ScreenCaptureService**: ç®¡ç† Android å±å¹•å½•åˆ¶æƒé™å’Œå‰å°æœåŠ¡
- **Native Modules**: å¤„ç† Android åŸç”ŸåŠŸèƒ½ï¼ˆå¦‚å‰å°æœåŠ¡ä¿æ´»ï¼‰

### 3.3 æœåŠ¡ç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æœåŠ¡ç«¯æ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              HTTP Server (Express)                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚ å¥åº·æ£€æŸ¥    â”‚ â”‚ APIè·¯ç”±     â”‚ â”‚ é™æ€æ–‡ä»¶    â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            WebSocket Server (Socket.io)             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚ è¿æ¥ç®¡ç†    â”‚ â”‚ è®¤è¯ä¸­é—´ä»¶  â”‚ â”‚ äº‹ä»¶å¤„ç†    â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Service Layer                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚  æˆ¿é—´ç®¡ç†æœåŠ¡    â”‚ â”‚  ç”¨æˆ·ç®¡ç†æœåŠ¡    â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - æˆ¿é—´CRUD      â”‚ â”‚ - ç”¨æˆ·ä¿¡æ¯      â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - æˆå‘˜ç®¡ç†      â”‚ â”‚ - åœ¨çº¿çŠ¶æ€      â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - æˆ¿é—´çŠ¶æ€      â”‚ â”‚ - æƒé™ç®¡ç†      â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚  ä¿¡ä»¤æœåŠ¡       â”‚ â”‚  æ—¥å¿—æœåŠ¡       â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - ä¿¡ä»¤è½¬å‘      â”‚ â”‚ - æ—¥å¿—è®°å½•      â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - ICEå€™é€‰      â”‚ â”‚ - é”™è¯¯è¿½è¸ª      â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Data Layer                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚  å†…å­˜å­˜å‚¨       â”‚ â”‚  æŒä¹…åŒ–å­˜å‚¨     â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - æˆ¿é—´Map       â”‚ â”‚ - æ—¥å¿—æ–‡ä»¶      â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ - ç”¨æˆ·Map       â”‚ â”‚ - é…ç½®æ–‡ä»¶      â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.1 HTTPæœåŠ¡å™¨èŒè´£

- **å¥åº·æ£€æŸ¥**: æä¾›`/health`æ¥å£ç”¨äºç›‘æ§
- **RESTful API**: æä¾›HTTPæ¥å£ï¼ˆå¦‚æˆ¿é—´åˆ—è¡¨æŸ¥è¯¢ï¼‰
- **é™æ€èµ„æº**: å¯é€‰çš„Webå®¢æˆ·ç«¯æ”¯æŒ

#### 3.3.2 WebSocketæœåŠ¡å™¨èŒè´£

- **è¿æ¥ç®¡ç†**: ç»´æŠ¤æ‰€æœ‰å®¢æˆ·ç«¯çš„WebSocketè¿æ¥
- **ä¿¡ä»¤è½¬å‘**: è½¬å‘WebRTCçš„offerã€answerã€ICEå€™é€‰
- **æˆ¿é—´å¹¿æ’­**: å‘æˆ¿é—´å†…æ‰€æœ‰æˆå‘˜å¹¿æ’­æ¶ˆæ¯
- **å¿ƒè·³æ£€æµ‹**: æ£€æµ‹å®¢æˆ·ç«¯è¿æ¥çŠ¶æ€

#### 3.3.3 ä¸šåŠ¡æœåŠ¡å±‚èŒè´£

- **æˆ¿é—´ç®¡ç†**: æˆ¿é—´çš„åˆ›å»ºã€åŠ å…¥ã€ç¦»å¼€ã€é”€æ¯
- **ç”¨æˆ·ç®¡ç†**: ç”¨æˆ·ä¿¡æ¯ã€åœ¨çº¿çŠ¶æ€ã€æƒé™æ§åˆ¶
- **ä¿¡ä»¤å¤„ç†**: WebRTCä¿¡ä»¤çš„éªŒè¯å’Œè½¬å‘
- **æ—¥å¿—è®°å½•**: ç³»ç»Ÿæ—¥å¿—ã€é”™è¯¯æ—¥å¿—ã€è®¿é—®æ—¥å¿—

---

## 4. æ ¸å¿ƒæµç¨‹è®¾è®¡

### 4.1 æˆ¿é—´åˆ›å»ºæµç¨‹

```
å®¢æˆ·ç«¯                          æœåŠ¡ç«¯
   â”‚                              â”‚
   â”‚  1. å‘é€åˆ›å»ºæˆ¿é—´è¯·æ±‚          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€ create-room â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚    {roomName, password}      â”‚
   â”‚                              â”‚  2. ç”Ÿæˆæˆ¿é—´ID
   â”‚                              â”‚  3. åˆ›å»ºæˆ¿é—´å¯¹è±¡
   â”‚                              â”‚  4. æ·»åŠ åˆ›å»ºè€…ä¸ºæˆå‘˜
   â”‚                              â”‚
   â”‚  5. è¿”å›æˆ¿é—´ä¿¡æ¯              â”‚
   â”‚<â”€â”€â”€â”€â”€ room-created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚    {roomId, roomInfo}        â”‚
   â”‚                              â”‚
   â”‚  6. åŠ å…¥Socket.ioæˆ¿é—´         â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€ join-room â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚    {roomId, userId}          â”‚
   â”‚                              â”‚  7. å°†SocketåŠ å…¥æˆ¿é—´
   â”‚                              â”‚  8. å¹¿æ’­æ–°æˆå‘˜åŠ å…¥
   â”‚<â”€â”€â”€ user-joined â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                              â”‚
   â”‚  9. æ›´æ–°æœ¬åœ°æˆ¿é—´çŠ¶æ€          â”‚
   â”‚                              â”‚
```

### 4.2 åŠ å…¥æˆ¿é—´æµç¨‹

```
å®¢æˆ·ç«¯A (æ–°åŠ å…¥)              æœåŠ¡ç«¯                    å®¢æˆ·ç«¯B (å·²åœ¨æˆ¿é—´)
    â”‚                         â”‚                            â”‚
    â”‚  1. è¯·æ±‚åŠ å…¥æˆ¿é—´         â”‚                            â”‚
    â”œâ”€â”€â”€â”€ join-room â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
    â”‚  {roomId, password}     â”‚                            â”‚
    â”‚                         â”‚  2. éªŒè¯å¯†ç                 â”‚
    â”‚                         â”‚  3. æ£€æŸ¥æˆ¿é—´æ˜¯å¦å·²æ»¡         â”‚
    â”‚                         â”‚                            â”‚
    â”‚  4. åŠ å…¥æˆåŠŸ             â”‚                            â”‚
    â”‚<â”€â”€â”€ join-success â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
    â”‚  {roomInfo, users}      â”‚                            â”‚
    â”‚                         â”‚                            â”‚
    â”‚                         â”‚  5. å¹¿æ’­æ–°æˆå‘˜åŠ å…¥           â”‚
    â”‚                         â”œâ”€â”€â”€â”€ user-joined â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                         â”‚  {userId, userInfo}        â”‚
    â”‚                         â”‚                            â”‚
    â”‚                         â”‚                            â”‚  6. å¦‚æœBåœ¨å…±äº«å±å¹•
    â”‚                         â”‚                            â”‚  åˆ™é€šçŸ¥A
    â”‚                         â”‚<â”€â”€â”€ notify-new-stream â”€â”€â”€â”€â”€â”¤
    â”‚                         â”‚                            â”‚
    â”‚  7. æ”¶åˆ°å±å¹•å…±äº«é€šçŸ¥     â”‚                            â”‚
    â”‚<â”€â”€â”€ stream-added â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
    â”‚  {streamId, userId}     â”‚                            â”‚
    â”‚                         â”‚                            â”‚
    â”‚  8. å‘èµ·WebRTCè¿æ¥       â”‚                            â”‚
    â”‚  (è¯¦è§WebRTCè¿æ¥æµç¨‹)    â”‚                            â”‚
    â”‚                         â”‚                            â”‚
```

### 4.3 WebRTCè¿æ¥å»ºç«‹æµç¨‹

```
å®¢æˆ·ç«¯A (Offerer)            æœåŠ¡ç«¯                  å®¢æˆ·ç«¯B (Answerer)
    â”‚                         â”‚                          â”‚
    â”‚  1. åˆ›å»ºPeerConnection   â”‚                          â”‚
    â”‚  2. æ·»åŠ æœ¬åœ°æµ           â”‚                          â”‚
    â”‚  3. åˆ›å»ºOffer            â”‚                          â”‚
    â”‚                         â”‚                          â”‚
    â”‚  4. å‘é€Offer            â”‚                          â”‚
    â”œâ”€â”€â”€â”€â”€ webrtc-offer â”€â”€â”€â”€â”€>â”‚                          â”‚
    â”‚  {targetId, offer, sdp}â”‚                          â”‚
    â”‚                         â”‚  5. è½¬å‘Offer             â”‚
    â”‚                         â”œâ”€â”€â”€â”€ webrtc-offer â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                         â”‚                          â”‚
    â”‚                         â”‚                          â”‚  6. æ¥æ”¶Offer
    â”‚                         â”‚                          â”‚  7. åˆ›å»ºPeerConnection
    â”‚                         â”‚                          â”‚  8. æ·»åŠ æœ¬åœ°æµ
    â”‚                         â”‚                          â”‚  9. åˆ›å»ºAnswer
    â”‚                         â”‚                          â”‚
    â”‚                         â”‚  10. å‘é€Answer           â”‚
    â”‚                         â”‚<â”€â”€â”€â”€ webrtc-answer â”€â”€â”€â”€â”€â”€â”¤
    â”‚                         â”‚  {targetId, answer, sdp} â”‚
    â”‚  11. æ¥æ”¶Answer          â”‚                          â”‚
    â”‚<â”€â”€â”€â”€ webrtc-answer â”€â”€â”€â”€â”€â”¤                          â”‚
    â”‚                         â”‚                          â”‚
    â”‚  12. äº¤æ¢ICEå€™é€‰         â”‚                          â”‚
    â”‚<â”€â”€â”€â”€ ice-candidate â”€â”€â”€â”€>â”‚<â”€â”€â”€â”€ ice-candidate â”€â”€â”€â”€â”€>â”‚
    â”‚                         â”‚                          â”‚
    â”‚  13. P2Pè¿æ¥å»ºç«‹æˆåŠŸ     â”‚                          â”‚
    â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
    â”‚              åª’ä½“æµç›´æ¥ä¼ è¾“ (ä¸ç»è¿‡æœåŠ¡ç«¯)             â”‚
    â”‚                                                      â”‚
```

### 4.4 å±å¹•å…±äº«æµç¨‹

```
å®¢æˆ·ç«¯                          æœåŠ¡ç«¯
   â”‚                              â”‚
   â”‚  1. ç”¨æˆ·ç‚¹å‡»"å¼€å§‹å…±äº«"        â”‚
   â”‚  2. è°ƒç”¨ä¸»è¿›ç¨‹APIè·å–æºåˆ—è¡¨   â”‚
   â”‚  3. æ˜¾ç¤ºæºé€‰æ‹©å™¨              â”‚
   â”‚  4. ç”¨æˆ·é€‰æ‹©å±å¹•/çª—å£         â”‚
   â”‚  5. è·å–MediaStream          â”‚
   â”‚                              â”‚
   â”‚  6. é€šçŸ¥æœåŠ¡å™¨å¼€å§‹å…±äº«         â”‚
   â”œâ”€â”€â”€â”€â”€ start-sharing â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚  {roomId, streamId}          â”‚
   â”‚                              â”‚  7. å¹¿æ’­ç»™æˆ¿é—´å†…å…¶ä»–æˆå‘˜
   â”‚                              â”œâ”€> user-started-sharing
   â”‚                              â”‚
   â”‚  8. ä¸ºæ¯ä¸ªè§‚çœ‹è€…åˆ›å»º           â”‚
   â”‚     PeerConnection            â”‚
   â”‚  9. æ·»åŠ MediaStreamåˆ°PC       â”‚
   â”‚  10. åˆ›å»ºOfferå¹¶å‘é€          â”‚
   â”‚  (æ‰§è¡ŒWebRTCè¿æ¥æµç¨‹)         â”‚
   â”‚                              â”‚
```

### 4.5 ç¦»å¼€æˆ¿é—´æµç¨‹

```
å®¢æˆ·ç«¯A (ç¦»å¼€)               æœåŠ¡ç«¯                   å®¢æˆ·ç«¯B (æˆ¿é—´å†…)
    â”‚                         â”‚                          â”‚
    â”‚  1. å…³é—­æ‰€æœ‰PeerConnectionâ”‚                         â”‚
    â”‚  2. åœæ­¢æœ¬åœ°æµ           â”‚                          â”‚
    â”‚                         â”‚                          â”‚
    â”‚  3. å‘é€ç¦»å¼€è¯·æ±‚         â”‚                          â”‚
    â”œâ”€â”€â”€â”€â”€ leave-room â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
    â”‚  {roomId, userId}       â”‚                          â”‚
    â”‚                         â”‚  4. ä»æˆ¿é—´ç§»é™¤ç”¨æˆ·        â”‚
    â”‚                         â”‚  5. å¦‚æœæ˜¯æˆ¿ä¸»ï¼Œè½¬ç§»æˆ¿ä¸»   â”‚
    â”‚                         â”‚  6. å¦‚æœæˆ¿é—´ä¸ºç©ºï¼Œé”€æ¯æˆ¿é—´ â”‚
    â”‚                         â”‚                          â”‚
    â”‚                         â”‚  7. å¹¿æ’­ç”¨æˆ·ç¦»å¼€          â”‚
    â”‚                         â”œâ”€â”€â”€â”€ user-left â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                         â”‚  {userId}               â”‚
    â”‚                         â”‚                          â”‚
    â”‚                         â”‚                          â”‚  8. å…³é—­ä¸Açš„
    â”‚                         â”‚                          â”‚     PeerConnection
    â”‚                         â”‚                          â”‚  9. æ›´æ–°UI
    â”‚                         â”‚                          â”‚
```

---

## 5. æ•°æ®æ¨¡å‹è®¾è®¡

### 5.1 æˆ¿é—´æ¨¡å‹ (Room)

```typescript
interface Room {
  id: string;                    // æˆ¿é—´ID (6ä½éšæœºå­—ç¬¦)
  name: string;                  // æˆ¿é—´åç§°
  password?: string;             // æˆ¿é—´å¯†ç  (å¯é€‰)
  hostId: string;                // æˆ¿ä¸»ç”¨æˆ·ID
  members: Map<string, User>;    // æˆ¿é—´æˆå‘˜ (userId -> User)
  streams: Map<string, Stream>;  // å…±äº«æµ (streamId -> Stream)
  maxMembers: number;            // æœ€å¤§æˆå‘˜æ•° (é»˜è®¤10)
  createdAt: Date;               // åˆ›å»ºæ—¶é—´
  updatedAt: Date;               // æ›´æ–°æ—¶é—´
}
```

### 5.2 ç”¨æˆ·æ¨¡å‹ (User)

```typescript
interface User {
  id: string;              // ç”¨æˆ·ID (UUID)
  nickname: string;        // æ˜µç§°
  avatar?: string;         // å¤´åƒURL (å¯é€‰)
  socketId: string;        // Socketè¿æ¥ID
  roomId: string;          // æ‰€åœ¨æˆ¿é—´ID
  isHost: boolean;         // æ˜¯å¦æ˜¯æˆ¿ä¸»
  isSharing: boolean;      // æ˜¯å¦æ­£åœ¨å…±äº«å±å¹•
  streamId?: string;       // å…±äº«æµID (å¦‚æœæ­£åœ¨å…±äº«)
  joinedAt: Date;          // åŠ å…¥æ—¶é—´
  lastActiveAt: Date;      // æœ€åæ´»è·ƒæ—¶é—´
}
```

### 5.3 æµæ¨¡å‹ (Stream)

```typescript
interface Stream {
  id: string;              // æµID (UUID)
  userId: string;          // æµæ‰€å±ç”¨æˆ·ID
  roomId: string;          // æµæ‰€åœ¨æˆ¿é—´ID
  type: 'screen' | 'window';  // å…±äº«ç±»å‹
  title: string;           // æµæ ‡é¢˜ (å±å¹•åç§°æˆ–çª—å£åç§°)
  resolution: {            // åˆ†è¾¨ç‡
    width: number;
    height: number;
  };
  frameRate: number;       // å¸§ç‡
  startedAt: Date;         // å¼€å§‹å…±äº«æ—¶é—´
}
```

### 5.4 WebRTCä¿¡ä»¤æ¶ˆæ¯

```typescript
// Offeræ¶ˆæ¯
interface OfferMessage {
  type: 'offer';
  fromUserId: string;
  toUserId: string;
  streamId: string;
  sdp: RTCSessionDescriptionInit;
}

// Answeræ¶ˆæ¯
interface AnswerMessage {
  type: 'answer';
  fromUserId: string;
  toUserId: string;
  streamId: string;
  sdp: RTCSessionDescriptionInit;
}

// ICEå€™é€‰æ¶ˆæ¯
interface IceCandidateMessage {
  type: 'ice-candidate';
  fromUserId: string;
  toUserId: string;
  candidate: RTCIceCandidateInit;
}
```

---

## 6. é€šä¿¡åè®®è®¾è®¡

### 6.1 Socket.io äº‹ä»¶åˆ—è¡¨

#### å®¢æˆ·ç«¯ â†’ æœåŠ¡ç«¯

| äº‹ä»¶å | å‚æ•° | æè¿° |
|-------|------|------|
| `create-room` | `{name, password?}` | åˆ›å»ºæˆ¿é—´ |
| `join-room` | `{roomId, password?, userInfo}` | åŠ å…¥æˆ¿é—´ |
| `leave-room` | `{roomId, userId}` | ç¦»å¼€æˆ¿é—´ |
| `start-sharing` | `{roomId, streamInfo}` | å¼€å§‹å±å¹•å…±äº« |
| `stop-sharing` | `{roomId, streamId}` | åœæ­¢å±å¹•å…±äº« |
| `webrtc-offer` | `{toUserId, offer}` | å‘é€WebRTC Offer |
| `webrtc-answer` | `{toUserId, answer}` | å‘é€WebRTC Answer |
| `ice-candidate` | `{toUserId, candidate}` | å‘é€ICEå€™é€‰ |
| `chat-message` | `{roomId, message}` | å‘é€èŠå¤©æ¶ˆæ¯ |

#### æœåŠ¡ç«¯ â†’ å®¢æˆ·ç«¯

| äº‹ä»¶å | å‚æ•° | æè¿° |
|-------|------|------|
| `room-created` | `{roomId, roomInfo}` | æˆ¿é—´åˆ›å»ºæˆåŠŸ |
| `join-success` | `{roomInfo, members, streams}` | åŠ å…¥æˆ¿é—´æˆåŠŸ |
| `join-error` | `{error}` | åŠ å…¥æˆ¿é—´å¤±è´¥ |
| `user-joined` | `{userId, userInfo}` | æ–°æˆå‘˜åŠ å…¥ |
| `user-left` | `{userId}` | æˆå‘˜ç¦»å¼€ |
| `stream-added` | `{streamId, streamInfo}` | æ–°å±å¹•å…±äº« |
| `stream-removed` | `{streamId, userId}` | å±å¹•å…±äº«åœæ­¢ |
| `webrtc-offer` | `{fromUserId, offer}` | æ”¶åˆ°WebRTC Offer |
| `webrtc-answer` | `{fromUserId, answer}` | æ”¶åˆ°WebRTC Answer |
| `ice-candidate` | `{fromUserId, candidate}` | æ”¶åˆ°ICEå€™é€‰ |
| `chat-message` | `{fromUserId, message}` | æ”¶åˆ°èŠå¤©æ¶ˆæ¯ |
| `room-closed` | `{reason}` | æˆ¿é—´å·²å…³é—­ |
| `error` | `{code, message}` | é”™è¯¯æ¶ˆæ¯ |

### 6.2 WebRTCé…ç½®

```typescript
const rtcConfiguration: RTCConfiguration = {
  iceServers: [
    // STUN æœåŠ¡å™¨ - ç”¨äºè·å–å…¬ç½‘åœ°å€
    { urls: 'stun:stun.l.google.com:19302' },
    { urls: 'stun:stun1.l.google.com:19302' },
    { urls: 'stun:stun.cloudflare.com:3478' },
    { urls: 'stun:stun.syncthing.net:3478' },
    { urls: 'stun:global.stun.twilio.com:3478' },
    // æ³¨æ„ï¼šæœ¬é¡¹ç›®ä¸æä¾› TURN æœåŠ¡å™¨
    // å¦‚éœ€éƒ¨ç½² TURNï¼Œè¯·è‡ªè¡Œé…ç½® Coturn ç­‰æœåŠ¡
  ],
  iceCandidatePoolSize: 10,
  bundlePolicy: 'max-bundle',
  rtcpMuxPolicy: 'require',
  // ä¼˜å…ˆä½¿ç”¨UDPä¼ è¾“
  iceTransportPolicy: 'all'
};

// åª’ä½“çº¦æŸ
const mediaConstraints = {
  video: {
    width: { ideal: 1920 },
    height: { ideal: 1080 },
    frameRate: { ideal: 30, max: 60 }
  },
  audio: false  // å±å¹•å…±äº«ä¸åŒ…å«éŸ³é¢‘
};
```

---

## 7. å®‰å…¨æ€§è®¾è®¡

### 7.1 ä¼ è¾“å®‰å…¨

- **WebSocket**: ä½¿ç”¨WSSï¼ˆWebSocket Secureï¼‰åŠ å¯†ä¼ è¾“
- **WebRTC**: ä½¿ç”¨DTLS-SRTPè‡ªåŠ¨åŠ å¯†åª’ä½“æµ
- **è¯ä¹¦**: æœåŠ¡å™¨ä½¿ç”¨æœ‰æ•ˆçš„SSL/TLSè¯ä¹¦

### 7.2 è®¤è¯ä¸æˆæƒ

```typescript
// æˆ¿é—´å¯†ç éªŒè¯
interface RoomAuth {
  roomId: string;
  password?: string;
}

// ç®€å•çš„å¯†ç å“ˆå¸Œ (ç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨bcrypt)
function validatePassword(input: string, stored: string): boolean {
  return input === stored;
}

// æˆ¿ä¸»æƒé™éªŒè¯
function isRoomHost(userId: string, room: Room): boolean {
  return room.hostId === userId;
}
```

### 7.3 æ•°æ®éªŒè¯

```typescript
// è¾“å…¥éªŒè¯ç¤ºä¾‹
interface ValidationRules {
  roomName: {
    minLength: 1,
    maxLength: 50,
    pattern: /^[a-zA-Z0-9\u4e00-\u9fa5\s-_]+$/
  },
  password: {
    minLength: 4,
    maxLength: 20,
    pattern: /^[a-zA-Z0-9]+$/
  },
  nickname: {
    minLength: 1,
    maxLength: 20,
    pattern: /^[a-zA-Z0-9\u4e00-\u9fa5_]+$/
  }
}
```

### 7.4 é˜²æ­¢æ”»å‡»

- **é¢‘ç‡é™åˆ¶**: é™åˆ¶å®¢æˆ·ç«¯è¯·æ±‚é¢‘ç‡ï¼Œé˜²æ­¢DOSæ”»å‡»
- **æˆ¿é—´æ•°é‡é™åˆ¶**: é™åˆ¶å•ä¸ªIPåˆ›å»ºçš„æˆ¿é—´æ•°é‡
- **è¿æ¥è¶…æ—¶**: è®¾ç½®åˆç†çš„è¿æ¥è¶…æ—¶æ—¶é—´
- **æ¶ˆæ¯å¤§å°é™åˆ¶**: é™åˆ¶å•æ¡æ¶ˆæ¯çš„å¤§å°

---

## 8. æ€§èƒ½ä¼˜åŒ–è®¾è®¡

### 8.1 å®¢æˆ·ç«¯ä¼˜åŒ–

#### 8.1.1 æµåª’ä½“ä¼˜åŒ–

```typescript
// è‡ªé€‚åº”ç ç‡
interface AdaptiveBitrateConfig {
  // æ ¹æ®ç½‘ç»œçŠ¶å†µè°ƒæ•´åˆ†è¾¨ç‡
  resolutions: [
    { width: 1920, height: 1080, minBandwidth: 2000 },  // 2Mbps
    { width: 1280, height: 720, minBandwidth: 1000 },   // 1Mbps
    { width: 640, height: 480, minBandwidth: 500 }      // 500kbps
  ];
  // æ ¹æ®CPUä½¿ç”¨ç‡è°ƒæ•´å¸§ç‡
  frameRates: [30, 24, 15, 10];
}
```

#### 8.1.2 æ¸²æŸ“ä¼˜åŒ–

- **è™šæ‹Ÿæ»šåŠ¨**: å½“å…±äº«å±å¹•æ•°é‡å¤šæ—¶ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
- **Canvasæ¸²æŸ“**: ä½¿ç”¨Canvasä¼˜åŒ–è§†é¢‘æ¸²æŸ“æ€§èƒ½
- **ç¡¬ä»¶åŠ é€Ÿ**: å¯ç”¨GPUåŠ é€Ÿè§†é¢‘è§£ç 

#### 8.1.3 å†…å­˜ç®¡ç†

- **åŠæ—¶é‡Šæ”¾**: æ–­å¼€è¿æ¥æ—¶åŠæ—¶é‡Šæ”¾MediaStreamå’ŒPeerConnection
- **å¯¹è±¡æ± **: å¤ç”¨PeerConnectionå¯¹è±¡
- **å¼±å¼•ç”¨**: ä½¿ç”¨WeakMapç®¡ç†ä¸´æ—¶å¯¹è±¡

### 8.2 æœåŠ¡ç«¯ä¼˜åŒ–

#### 8.2.1 è¿æ¥ç®¡ç†

```typescript
// è¿æ¥æ± é…ç½®
const connectionConfig = {
  maxConnections: 1000,        // æœ€å¤§è¿æ¥æ•°
  connectionTimeout: 30000,     // è¿æ¥è¶…æ—¶ (30ç§’)
  heartbeatInterval: 10000,     // å¿ƒè·³é—´éš” (10ç§’)
  heartbeatTimeout: 5000        // å¿ƒè·³è¶…æ—¶ (5ç§’)
};
```

#### 8.2.2 æ¶ˆæ¯è½¬å‘ä¼˜åŒ–

- **æ‰¹é‡å¤„ç†**: æ‰¹é‡è½¬å‘æ¶ˆæ¯ï¼Œå‡å°‘IOæ¬¡æ•°
- **æ¶ˆæ¯å‹ç¼©**: ä½¿ç”¨Socket.ioçš„permessage-deflateå‹ç¼©
- **ä¼˜å…ˆçº§é˜Ÿåˆ—**: ä¿¡ä»¤æ¶ˆæ¯ä¼˜å…ˆäºæ™®é€šæ¶ˆæ¯

#### 8.2.3 å†…å­˜ä¼˜åŒ–

- **æˆ¿é—´è‡ªåŠ¨æ¸…ç†**: ç©ºæˆ¿é—´è‡ªåŠ¨é”€æ¯
- **åƒåœ¾å›æ”¶**: å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
- **å†…å­˜ç›‘æ§**: ç›‘æ§å†…å­˜ä½¿ç”¨ï¼ŒåŠæ—¶å‘Šè­¦

---

## 9. ç›‘æ§ä¸æ—¥å¿—

### 9.1 æ—¥å¿—åˆ†ç±»

| æ—¥å¿—ç±»å‹ | çº§åˆ« | å†…å®¹ | ä¿å­˜ä½ç½® |
|---------|------|------|---------|
| **è®¿é—®æ—¥å¿—** | INFO | ç”¨æˆ·è¿æ¥ã€æ–­å¼€ã€æˆ¿é—´æ“ä½œ | `logs/access.log` |
| **é”™è¯¯æ—¥å¿—** | ERROR | å¼‚å¸¸ã€é”™è¯¯å †æ ˆ | `logs/error.log` |
| **æ€§èƒ½æ—¥å¿—** | INFO | å“åº”æ—¶é—´ã€èµ„æºä½¿ç”¨ | `logs/performance.log` |
| **è°ƒè¯•æ—¥å¿—** | DEBUG | è¯¦ç»†è°ƒè¯•ä¿¡æ¯ | `logs/debug.log` |

### 9.2 ç›‘æ§æŒ‡æ ‡

```typescript
interface SystemMetrics {
  // æœåŠ¡å™¨æŒ‡æ ‡
  server: {
    cpuUsage: number;          // CPUä½¿ç”¨ç‡
    memoryUsage: number;       // å†…å­˜ä½¿ç”¨ç‡
    activeConnections: number; // æ´»è·ƒè¿æ¥æ•°
    totalRooms: number;        // æˆ¿é—´æ€»æ•°
  };
  
  // ç½‘ç»œæŒ‡æ ‡
  network: {
    bytesReceived: number;     // æ¥æ”¶å­—èŠ‚æ•°
    bytesSent: number;         // å‘é€å­—èŠ‚æ•°
    messagesPerSecond: number; // æ¶ˆæ¯æ•°/ç§’
  };
  
  // ä¸šåŠ¡æŒ‡æ ‡
  business: {
    totalUsers: number;        // æ€»ç”¨æˆ·æ•°
    activeStreams: number;     // æ´»è·ƒæµæ•°
    avgRoomSize: number;       // å¹³å‡æˆ¿é—´äººæ•°
  };
}
```

### 9.3 æ—¥å¿—æ ¼å¼

```typescript
// Winstonæ—¥å¿—é…ç½®
const logFormat = winston.format.combine(
  winston.format.timestamp({ format: 'YYYY-MM-DD HH:mm:ss' }),
  winston.format.errors({ stack: true }),
  winston.format.json()
);

// æ—¥å¿—ç¤ºä¾‹
{
  "timestamp": "2026-01-04 14:30:00",
  "level": "info",
  "message": "User joined room",
  "userId": "user-123",
  "roomId": "room-abc",
  "socketId": "socket-xyz"
}
```

---

## 10. éƒ¨ç½²æ¶æ„

### 10.1 éƒ¨ç½²æ‹“æ‰‘å›¾

```
                      Internet
                         â”‚
                         â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Load Balancer     â”‚
              â”‚   (Nginx/HAProxy)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚             â”‚             â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚  ä¿¡ä»¤æœåŠ¡å™¨ â”‚ â”‚  ä¿¡ä»¤æœåŠ¡å™¨ â”‚ â”‚ ä¿¡ä»¤æœåŠ¡å™¨â”‚
    â”‚  Node 1    â”‚ â”‚  Node 2    â”‚ â”‚  Node 3  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚             â”‚             â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Redis (å¯é€‰)      â”‚
              â”‚   ä¼šè¯å…±äº«/æ¶ˆæ¯é˜Ÿåˆ—  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 å•æœºéƒ¨ç½²ï¼ˆé€‚åˆå°å›¢é˜Ÿï¼‰

```yaml
# Docker Compose é…ç½®
version: '3.8'
services:
  signaling-server:
    image: screen-sharing-server:latest
    ports:
      - "3000:3000"
      - "443:443"
    environment:
      - NODE_ENV=production
      - PORT=3000
    volumes:
      - ./logs:/app/logs
      - ./config:/app/config
    restart: always

# æ³¨æ„ï¼šæœ¬é¡¹ç›®ä¸æä¾› TURN æœåŠ¡å™¨
# å¦‚éœ€éƒ¨ç½² TURN æœåŠ¡å™¨ï¼Œè¯·è‡ªè¡Œé…ç½® Coturn
```

### 10.3 ç³»ç»Ÿè¦æ±‚

#### æœåŠ¡ç«¯

| é…ç½®é¡¹ | æœ€ä½è¦æ±‚ | æ¨èé…ç½® |
|-------|---------|---------|
| **CPU** | 2æ ¸å¿ƒ | 4æ ¸å¿ƒ |
| **å†…å­˜** | 2GB | 4GB |
| **å¸¦å®½** | 10Mbps | 50Mbps |
| **å­˜å‚¨** | 20GB | 50GB SSD |
| **æ“ä½œç³»ç»Ÿ** | Ubuntu 20.04+ | Ubuntu 22.04 LTS |

#### å®¢æˆ·ç«¯

| é…ç½®é¡¹ | æœ€ä½è¦æ±‚ | æ¨èé…ç½® |
|-------|---------|---------|
| **CPU** | Intel i3 / AMDåŒçº§ | Intel i5 / AMDåŒçº§ |
| **å†…å­˜** | 4GB | 8GB |
| **æ˜¾å¡** | é›†æˆæ˜¾å¡ | ç‹¬ç«‹æ˜¾å¡ |
| **ç½‘ç»œ** | 5Mbps | 10Mbps |

---

## 11. æŠ€æœ¯é£é™©ä¸å¯¹ç­–

### 11.1 æŠ€æœ¯é£é™©çŸ©é˜µ

| é£é™© | æ¦‚ç‡ | å½±å“ | ç­‰çº§ | å¯¹ç­– |
|------|------|------|------|------|
| **NATç©¿é€å¤±è´¥** | ä¸­ | é«˜ | ğŸ”´ é«˜ | æç¤ºç”¨æˆ·ç½‘ç»œç¯å¢ƒè¦æ±‚ï¼Œæˆ–è‡ªè¡Œéƒ¨ç½²TURNæœåŠ¡å™¨ |
| **å¤§æ–‡ä»¶ä¼ è¾“å¤±è´¥** | ä½ | ä¸­ | ğŸŸ¡ ä¸­ | ä¸æ”¯æŒæ–‡ä»¶ä¼ è¾“åŠŸèƒ½ |
| **æµè§ˆå™¨å…¼å®¹æ€§** | ä½ | ä¸­ | ğŸŸ¡ ä¸­ | ä½¿ç”¨Electronç»Ÿä¸€ç¯å¢ƒ |
| **ç½‘ç»œæŠ–åŠ¨** | é«˜ | ä¸­ | ğŸŸ¡ ä¸­ | å®ç°è‡ªé€‚åº”ç ç‡ |
| **æœåŠ¡å™¨è¿‡è½½** | ä½ | é«˜ | ğŸŸ¡ ä¸­ | é™åˆ¶æˆ¿é—´æ•°å’Œè¿æ¥æ•° |
| **å†…å­˜æ³„æ¼** | ä¸­ | ä¸­ | ğŸŸ¡ ä¸­ | ä¸¥æ ¼çš„èµ„æºé‡Šæ”¾ï¼Œå®šæœŸé‡å¯ |

### 11.2 é™çº§æ–¹æ¡ˆ

```typescript
// é™çº§ç­–ç•¥é…ç½®
interface FallbackStrategy {
  // è¿æ¥é™çº§ï¼šæ£€æµ‹ NAT ç±»å‹ï¼Œæç¤ºç”¨æˆ·
  connectionFallback: {
    p2pTimeout: 5000,          // P2Pè¿æ¥è¶…æ—¶æ—¶é—´
    iceRestartCount: 3         // ICE é‡å¯æ¬¡æ•°
  };

  // è´¨é‡é™çº§ï¼šé«˜æ¸… â†’ æ ‡æ¸…
  qualityFallback: {
    highQuality: { width: 1920, height: 1080, fps: 30 },
    mediumQuality: { width: 1280, height: 720, fps: 24 },
    lowQuality: { width: 640, height: 480, fps: 15 }
  };

  // åŠŸèƒ½é™çº§ï¼šå¤šäººå…±äº« â†’ å•äººå…±äº«
  featureFallback: {
    maxConcurrentStreams: 3,   // æœ€å¤§åŒæ—¶å…±äº«æ•°
    maxRoomMembers: 10         // æœ€å¤§æˆ¿é—´äººæ•°
  };
}
```

---

## 12. æŠ€æœ¯æ¼”è¿›è§„åˆ’

### 12.1 å½“å‰ç‰ˆæœ¬ (v1.0)

- âœ… åŸºç¡€æˆ¿é—´ç®¡ç†
- âœ… P2På±å¹•å…±äº«
- âœ… å¤šäººè§‚çœ‹
- âœ… WebSocketä¿¡ä»¤

### 12.2 æœªæ¥ç‰ˆæœ¬

#### v1.1 - å¢å¼ºåŠŸèƒ½
- ğŸ”² èŠå¤©åŠŸèƒ½
- ğŸ”² ç³»ç»ŸéŸ³é¢‘å…±äº«
- ğŸ”² ç½‘ç»œè´¨é‡è‡ªé€‚åº”

#### v1.2 - æ€§èƒ½ä¼˜åŒ–
- ğŸ”² SFUæ¶æ„æ”¯æŒï¼ˆå¤„ç†å¤§è§„æ¨¡åœºæ™¯ï¼‰
- ğŸ”² æœåŠ¡ç«¯å½•åˆ¶
- ğŸ”² AIé™å™ª

#### v2.0 - ä¼ä¸šç‰ˆ
- ğŸ”² ç”¨æˆ·ç³»ç»Ÿ
- ğŸ”² æƒé™ç®¡ç†
- ğŸ”² ä¼šè®®å½•åˆ¶ä¸å›æ”¾
- ğŸ”² å±å¹•æ ‡æ³¨ä¸åä½œ

---

## 13. å‚è€ƒèµ„æ–™

### 13.1 æŠ€æœ¯æ–‡æ¡£

- **WebRTC**: https://webrtc.org/
- **Electron**: https://www.electronjs.org/docs/latest
- **Socket.io**: https://socket.io/docs/v4/
- **Coturn**: https://github.com/coturn/coturn

### 13.2 ç›¸å…³æ ‡å‡†

- **RFC 8825**: WebRTC Overview
- **RFC 8826**: WebRTC Security Architecture
- **RFC 8829**: JavaScript Session Establishment Protocol

### 13.3 æœ€ä½³å®è·µ

- Electronå®‰å…¨æŒ‡å—
- WebRTCæ€§èƒ½ä¼˜åŒ–
- Socket.ioæ‰©å±•æ–¹æ¡ˆ

---

## 14. é™„å½•

### 14.1 æŠ€æœ¯é€‰å‹å¯¹æ¯”

#### æ¡Œé¢æ¡†æ¶å¯¹æ¯”

| æ¡†æ¶ | ä¼˜åŠ¿ | åŠ£åŠ¿ | ç»“è®º |
|------|------|------|------|
| **Electron** | è·¨å¹³å°ã€æˆç†Ÿã€ç¤¾åŒºå¤§ | åŒ…ä½“ç§¯å¤§ | âœ… é€‰ç”¨ |
| **Tauri** | åŒ…ä½“ç§¯å°ã€æ€§èƒ½å¥½ | ç”Ÿæ€ä¸æˆç†Ÿ | âŒ ä¸é€‰ |
| **NW.js** | ä¸Electronç±»ä¼¼ | ç¤¾åŒºè¾ƒå° | âŒ ä¸é€‰ |

#### æµåª’ä½“æ¶æ„å¯¹æ¯”

| æ¶æ„ | ä¼˜åŠ¿ | åŠ£åŠ¿ | é€‚ç”¨åœºæ™¯ |
|------|------|------|---------|
| **P2P (Mesh)** | å»¶è¿Ÿä½ã€æœåŠ¡å™¨å‹åŠ›å° | å®¢æˆ·ç«¯ä¸Šä¼ å‹åŠ›å¤§ | âœ… 5-10äººå°å›¢é˜Ÿ |
| **SFU** | æ‰©å±•æ€§å¥½ | æœåŠ¡å™¨å‹åŠ›å¤§ | 10-50äººä¸­å‹ä¼šè®® |
| **MCU** | å®¢æˆ·ç«¯å‹åŠ›å° | å»¶è¿Ÿé«˜ã€æˆæœ¬é«˜ | 50+äººå¤§å‹ä¼šè®® |

### 14.2 å…³é”®ä»£ç ç‰‡æ®µ

```typescript
// PeerConnectionåˆ›å»ºç¤ºä¾‹
class PeerConnectionManager {
  private peerConnections: Map<string, RTCPeerConnection>;
  
  async createPeerConnection(
    remoteUserId: string,
    localStream: MediaStream
  ): Promise<RTCPeerConnection> {
    const pc = new RTCPeerConnection(rtcConfiguration);
    
    // æ·»åŠ æœ¬åœ°æµ
    localStream.getTracks().forEach(track => {
      pc.addTrack(track, localStream);
    });
    
    // å¤„ç†ICEå€™é€‰
    pc.onicecandidate = (event) => {
      if (event.candidate) {
        this.sendIceCandidate(remoteUserId, event.candidate);
      }
    };
    
    // å¤„ç†è¿œç¨‹æµ
    pc.ontrack = (event) => {
      this.handleRemoteStream(remoteUserId, event.streams[0]);
    };
    
    this.peerConnections.set(remoteUserId, pc);
    return pc;
  }
}
```

---

**æ–‡æ¡£ç»“æŸ**
