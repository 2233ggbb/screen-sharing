# 多人屏幕共享系统 - 产品需求文档（PRD）

## 文档信息

| 项目名称 | 多人屏幕共享系统 |
|---------|-----------------|
| 文档版本 | v1.0 |
| 创建日期 | 2026-01-04 |
| 产品类型 | 桌面应用 + 服务端系统 |
| 目标用户 | 小型团队（5-10人） |

---

## 1. 项目概述

### 1.1 产品定位

多人屏幕共享系统是一款面向小型团队的实时屏幕共享协作工具，支持多人同时分享屏幕，多人实时观看。适用于远程会议、团队协作、技术演示等场景。

### 1.2 产品目标

- **实时性**: 低延迟的屏幕共享体验（< 500ms）
- **易用性**: 简单直观的操作流程，快速上手
- **稳定性**: 稳定的连接质量，支持网络波动
- **跨平台**: 支持 Windows、macOS、Linux 三大平台
- **隐私性**: 用户可选择共享的窗口，保护隐私

### 1.3 核心价值

- **团队协作**: 支持多人同时分享，促进团队沟通
- **灵活分享**: 可选择共享整个屏幕或特定窗口
- **轻量级**: 针对小团队优化，部署简单，资源占用低

---

## 2. 用户角色

### 2.1 角色定义

| 角色 | 描述 | 权限 |
|------|------|------|
| **房主（Host）** | 创建房间的用户 | 可管理房间、移除用户、关闭房间 |
| **分享者（Presenter）** | 正在分享屏幕的用户 | 可启动/停止自己的屏幕共享 |
| **观看者（Viewer）** | 观看屏幕共享的用户 | 可查看所有分享者的屏幕 |

### 2.2 角色转换

- 任何成员都可以成为分享者（同时开启屏幕共享）
- 房主身份在房主离开时自动转移给最早加入的成员
- 所有用户默认都是观看者

---

## 3. 功能需求

### 3.1 核心功能

#### 3.1.1 房间管理

**功能描述**: 用户可以创建或加入房间进行屏幕共享

**需求细节**:
- **创建房间**
  - 生成唯一的房间ID（6位数字或字母组合）
  - 可选设置房间名称
  - 可选设置房间密码
  - 显示房间人数上限（默认10人）
  
- **加入房间**
  - 输入房间ID
  - 如有密码，输入密码验证
  - 验证房间是否已满
  - 自动连接并进入房间
  
- **离开房间**
  - 主动离开房间
  - 自动停止屏幕共享
  - 通知其他成员

- **房间列表**
  - 显示当前在线房间数量
  - 显示房间内成员数量
  - 快速重新加入最近的房间

**优先级**: P0（必须实现）

#### 3.1.2 屏幕共享

**功能描述**: 用户可以选择共享屏幕或窗口，并推流给房间内其他成员

**需求细节**:
- **共享源选择**
  - 显示所有可用的屏幕（多显示器支持）
  - 显示所有可用的应用窗口列表
  - 提供缩略图预览
  - 记住用户上次选择

- **开始共享**
  - 选择共享源后开始推流
  - 显示"正在共享"状态指示
  - 显示共享预览（小窗口）
  
- **共享控制**
  - 暂停/恢复共享
  - 停止共享
  - 切换共享源
  - 调整共享质量（分辨率/帧率）

- **音频共享（可选）**
  - 可选择是否共享系统音频
  - 音频音量控制

**优先级**: P0（必须实现）

#### 3.1.3 多屏观看

**功能描述**: 观看者可以同时查看房间内所有人的屏幕共享

**需求细节**:
- **多屏布局**
  - 网格布局：平铺显示所有共享屏幕
  - 自适应布局：根据共享数量自动调整
  - 最大支持同时显示10个共享屏幕

- **焦点模式**
  - 点击某个屏幕进入全屏/放大模式
  - 其他屏幕缩小显示在侧边栏
  - 支持快速切换焦点

- **屏幕标识**
  - 显示分享者的昵称
  - 显示屏幕共享的标题（窗口名称）
  - 显示网络质量指示器

**优先级**: P0（必须实现）

#### 3.1.4 用户管理

**功能描述**: 管理房间内的用户信息和状态

**需求细节**:
- **用户信息**
  - 设置昵称（必填）
  - 设置头像（可选）
  - 显示在线状态
  
- **用户列表**
  - 显示房间内所有成员
  - 显示成员角色（房主/分享者/观看者）
  - 显示成员网络状态

- **用户操作**（房主专属）
  - 移除用户
  - 禁止用户分享
  - 转移房主权限

**优先级**: P1（重要）

### 3.2 辅助功能

#### 3.2.1 设置中心

**需求细节**:
- **基础设置**
  - 昵称设置
  - 语言选择（中文/英文）
  - 主题切换（亮色/暗色）
  
- **视频设置**
  - 默认分辨率（720p/1080p）
  - 默认帧率（15fps/30fps）
  - 硬件加速开关

- **网络设置**
  - 服务器地址配置
  - 端口配置
  - 连接超时设置

**优先级**: P1（重要）

#### 3.2.2 网络质量监控

**需求细节**:
- 实时显示网络延迟
- 显示上传/下载速度
- 显示丢包率
- 网络状态告警（差/良好/优秀）

**优先级**: P2（可选）

#### 3.2.3 聊天功能

**需求细节**:
- 房间内文字聊天
- 支持发送链接
- 聊天记录保存
- 未读消息提示

**优先级**: P2（可选）

---

## 4. 用户使用流程

### 4.1 创建房间并共享屏幕

```
1. 用户启动应用
2. 进入首页
3. 点击"创建房间"
4. 设置房间名称（可选）和密码（可选）
5. 创建成功，进入房间
6. 点击"开始共享"
7. 选择要共享的屏幕或窗口
8. 确认并开始共享
9. 分享房间ID给其他成员
```

### 4.2 加入房间并观看

```
1. 用户启动应用
2. 进入首页
3. 点击"加入房间"
4. 输入房间ID
5. 输入密码（如有）
6. 验证通过，进入房间
7. 自动显示房间内所有共享屏幕
8. 可点击任意屏幕进入焦点模式
```

### 4.3 多人同时分享

```
1. 用户A已在房间内分享屏幕
2. 用户B加入同一房间
3. 用户B点击"开始共享"
4. 选择自己的共享源
5. 房间内现在显示A和B的屏幕
6. 所有成员可同时查看两个屏幕
```

---

## 5. 非功能性需求

### 5.1 性能需求

| 指标 | 要求 | 说明 |
|------|------|------|
| **屏幕共享延迟** | < 500ms | 从分享者到观看者的端到端延迟 |
| **应用启动时间** | < 3秒 | 从点击图标到显示界面 |
| **房间加入时间** | < 2秒 | 从点击加入到显示共享画面 |
| **CPU占用** | < 30% | 共享1080p屏幕时 |
| **内存占用** | < 500MB | 观看3个共享屏幕时 |
| **同时在线用户** | 10人 | 单个房间最大支持人数 |

### 5.2 兼容性需求

| 平台 | 最低版本 | 说明 |
|------|---------|------|
| **Windows** | Windows 10 | 64位 |
| **macOS** | macOS 10.15+ | Intel/Apple Silicon |
| **Linux** | Ubuntu 20.04+ | 主流发行版 |

### 5.3 安全性需求

- **数据传输**: WebRTC加密传输（DTLS-SRTP）
- **房间密码**: 支持密码保护，防止未授权访问
- **隐私保护**: 用户主动选择共享内容，避免泄露隐私
- **连接安全**: 服务器支持WSS（WebSocket Secure）

### 5.4 可用性需求

- **界面语言**: 支持中文、英文
- **操作引导**: 首次使用提供操作指引
- **错误提示**: 清晰的错误信息和解决建议
- **离线提示**: 网络断开时明确提示用户

### 5.5 可维护性需求

- **日志记录**: 完整的客户端和服务端日志
- **错误追踪**: 自动上报崩溃信息（需用户同意）
- **版本更新**: 支持自动检查更新
- **配置管理**: 所有配置项可通过文件修改

---

## 6. 约束与限制

### 6.1 技术约束

- 基于 Electron 开发，应用包体积较大（约100MB）
- WebRTC 依赖浏览器内核版本，需确保 Electron 版本足够新
- P2P 连接可能受防火墙影响，需要 TURN 服务器作为中继

### 6.2 业务约束

- 项目初期只支持小型团队（5-10人）
- 不提供云录制功能
- 不提供回放功能
- 房间在所有人离开后自动销毁

### 6.3 资源约束

- 服务器需要公网IP
- 需要足够的带宽支持多路流传输
- TURN 服务器需要较大带宽（如果P2P失败）

---

## 7. 成功指标

### 7.1 核心指标

- **连接成功率** ≥ 95%
- **平均延迟** < 500ms
- **崩溃率** < 1%
- **用户留存率** ≥ 80%（7天）

### 7.2 用户体验指标

- **操作步骤** ≤ 5步完成屏幕共享
- **学习时间** < 5分钟掌握基本操作
- **用户满意度** ≥ 4分（5分制）

---

## 8. 里程碑规划

### 阶段一：核心功能（MVP）
- ✅ 房间管理（创建/加入/离开）
- ✅ 单人屏幕共享
- ✅ 多人观看
- ✅ 基础用户管理

### 阶段二：完善功能
- ✅ 多人同时分享
- ✅ 焦点模式
- ✅ 网络质量监控
- ✅ 设置中心

### 阶段三：增强功能
- ⏸️ 聊天功能
- ⏸️ 音频共享
- ⏸️ 录制功能（本地）
- ⏸️ 屏幕标注

---

## 9. 风险与挑战

### 9.1 技术风险

| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| **NAT穿透失败** | 高 | 部署TURN中继服务器 |
| **带宽不足** | 中 | 自动降低分辨率和帧率 |
| **防火墙限制** | 中 | 提供配置指南，使用标准端口 |
| **跨平台兼容性** | 低 | 充分测试各平台，使用成熟框架 |

### 9.2 业务风险

| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| **服务器成本** | 中 | 优化架构，降低带宽消耗 |
| **用户接受度** | 中 | 提供试用版本，收集用户反馈 |
| **竞品压力** | 低 | 专注小团队场景，差异化竞争 |

---

## 10. 附录

### 10.1 术语表

- **WebRTC**: Web Real-Time Communication，实时音视频通信技术
- **P2P**: Peer-to-Peer，点对点连接
- **TURN**: Traversal Using Relays around NAT，NAT中继穿透服务
- **STUN**: Session Traversal Utilities for NAT，NAT会话穿透工具
- **SFU**: Selective Forwarding Unit，选择性转发单元
- **信令服务器**: 用于协调WebRTC连接建立的服务器

### 10.2 参考资料

- WebRTC官方文档: https://webrtc.org/
- Electron官方文档: https://www.electronjs.org/
- Socket.io官方文档: https://socket.io/

---

## 11. 变更记录

| 版本 | 日期 | 修改内容 | 修改人 |
|------|------|---------|--------|
| v1.0 | 2026-01-04 | 初始版本 | 系统 |
